AGENTS.md — SPECIFIC-GERPAAS · Variant B (FamilyName→Article)
1) Коротко о цели
Единая зведена специфікація кабеленесучої системи за ДСТУ 9243.10:2023 (9-графка) з поділом на розділи за GE_Категорія. Плагін не пише текст безпосередньо в таблицю Revit; він заповнює параметри елементів:
GE_Категорія (секції спеки),
GE_Найменування (графа 2),
GE_Артикул (графа 3).
Решта граф (одиниця, кількість, маса, примітки, коди) — ведуться стандартними полями/формулами та існуючими проектними параметрами (як у користувача зараз).
2) Ground truth & ключові рішення
Варіант Б: ідентифікація типу виробу за FamilyName з мапи FamilyMap.csv; розміри — з параметра “Размер”; кут — з DKC_Angle; товщина та покриття — з комбіків плагіна; довжина лотка — із ini.
Пишемо тільки GE_Категорія, GE_Найменування, GE_Артикул.
Спека вже створена вручну під назвою GE_Специфікація кабеленесучих систем і містить налаштовані поля 1…9 (як описано користувачем).
Цільове середовище: Revit 2022, C# 7.3 (увага на сумісність API та синтаксису).
3) Ролі (агенти) та зони відповідальності
Product Owner (PO) — Сергій
Визначає вимоги ДСТУ/ГОСТ, затверджує складання граф та наповнення.
Tech Lead / Архітектор — (чат-помічник)
Консолідує рішення, тримає інваріанти (Variant B), контролює API-ризики.
Dev: Revit/.NET
Парсинг FamilyMap.csv → Dictionary<string,string>.
Витяг розмірів/кутів/товщини/покриття.
Формування рядків GE_Найменування, GE_Артикул.
Запис у параметри елементів (Transaction).
Dev: Data Mapping
Підтримка FamilyMap.csv, правило кодування ширини/висоти/кутів/покриттів.
QA
Тести на зразках моделей (лотки/відводи/тройники/кришки), звірка з каталожними описами.
Catalog Owner
Контроль узгодженості з БД/каталогом (масові значення, позначення покриттів).
Config/Release
Шлях до /Data/FamilyMap.csv, setup.ini; копіювання “Всегда копировать”; складання релізу.
4) Постачання (deliverables)
Utils/FamilyMapLoader.cs — читання CSV в Dictionary<string,string>.
Логіка формування:
Лоток: Лоток перфорований {W}x{H}x{L}x{t}мм, {метод} → GE-KT2-....
Кут (гор.): Кут горизонтальний {α} град. {W}x{H}x{t}мм, {метод} → GE-KT2-D{α}-....
(Розширення: тройник/перехід/хрестовина — за шаблоном.)
SpecSynchronizer:
зчитування комбиків (товщина, покриття),
визначення FamilyName → BaseArticle,
запис в GE_Категорія / GE_Найменування / GE_Артикул.
Інструкція для користувача (README snippet) щодо оновлення FamilyMap.csv.
5) Definition of Done (DoD)
На тестовій моделі: кожен елемент КНС має валідні:
GE_Категорія (один із: «1. Кабельні лотки», «2. З'єднувальні деталі», «3. Монтажні вироби»),
GE_Найменування — відповідно до каталожної фразеології,
GE_Артикул — відповідає кодуванню ширини/висоти/куту/покриття/товщини.
В GE_Специфікація кабеленесучих систем колонки 2 і 3 заповнені без ручного редагування.
Логи чисті (тільки ключові WARN/ERROR), зборка без попереджень по C# 7.3.
Оновлення FamilyMap.csv не потребує перекомпіляції.
6) Ризики / нецілі
Неціль: автомат заповнення всіх 9 граф прямо зараз — робимо поетапно (2 і 3 графи вже, «1/4/5/6/7/8/9» — за потребою, окремими тасками).
Ризик: нестандартні/неоднорідні FamilyName → потрібна дисципліна у FamilyMap.
Ризик: зміни API Revit → тримати мінімальний набір викликів (Transactions, LookupParameter).
7) Комунікації та артефакти
Дані: /Data/FamilyMap.csv, setup.ini.
Спека: GE_Специфікація кабеленесучих систем.
Логи: message.log (ротація за розміром), рівні: INFO (старт/кінець), WARN (невідповідності), ERROR (виключення).