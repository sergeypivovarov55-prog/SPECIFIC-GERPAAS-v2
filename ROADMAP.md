ROADMAP.md — SPECIFIC-GERPAAS · Variant B (FamilyName→Article)
0) Поточний статус (2025-10-07)
Створено і підключено FamilyMap.csv (Copy Always).
В Revit вручну готова спільна спека GE_Специфікація кабеленесучих систем з 9 графами та параметрами проекту:
заповнювати плагіном: GE_Категорія, GE_Найменування, GE_Артикул;
решта граф — уже налаштовані/обчислювані у проєкті.
Реалізація Variant B триває (парсинг FamilyName, параметризовані рядки для граф 2 і 3).
1) Мета спринту
Видати працюючу версію, яка:
заповнює GE_Категорія / GE_Найменування / GE_Артикул для всіх елементів КНС;
дає коректний вивід у 2 і 3 графах зведеної спеки;
має чистий лог і стабільні транзакції.
2) Етапи (майлстоуни)
M1. Пайплайн FamilyMap (готово/уточнення)
 Валідація CSV: без кінцевих ;, UTF-8 без BOM.
 Завантаження у Dictionary<string,string> (кейс-інсенситив).
 Мінімальна діагностика (порожні рядки, дублікати ключів → WARN).
M2. Розпізнавання та збирання рядків
 Витяг: FamilyName, Размер (W/H[/…]), DKC_Angle, товщина/покриття з комбиків, довжина з ini.
 Правила формування:
Лотки: Лоток перфорований W×H×L×t мм, метод … → GE-KT2-<Wcode>-<Hcode>-<t>-<coat>.
Кути (гор.): Кут горизонтальний α град. W×H×t мм, метод … → GE-KT2-Dα-<Wcode>-<Hcode>-<t>-<coat>.
Тройники/переходи/хрестовини: (шаблон на базі BaseArticle; уточнюється після M2.1).
 Юніт-тести на формувачах рядків (in-memory).
M3. Запис у параметри елементів (Transaction)
 Для кожного елемента: SetTextParam(..., "GE_Категорія", ...).
 SetTextParam(..., "GE_Найменування", ...).
 SetTextParam(..., "GE_Артикул", ...).
 Обробка ReadOnly/Null параметрів з WARN.
M4. Інтеграція зі специфікацією
 Перевірка наявності GE_Специфікація кабеленесучих систем.
 Перевірка присутності колонок, за необхідності — авто-додавання саме двох полів (GE_Найменування, GE_Артикул) у визначення спеки (якщо потрібно, але краще зберегти ручну конфігурацію користувача недоторканою).
 Перевірка групування/сортування за GE_Категорія (поле може бути приховане).
M5. Якість та продуктивність
 Логи: лише старт/підсумок, WARN на невідповідності FamilyMap/параметрів.
 Обробка великих моделей: уникати повторного читання CSV, мінімізувати пошук через LookupParameter.
 Захист від падіння (try/catch, Transaction rollback → ERROR).
M6. Розширення на аксесуари (пізніше)
 Категоризація GE_Категорія="3. Монтажні вироби".
 Шаблони рядків для аксесуарів (по каталогу).
3) Прийомка (acceptance)
Контрольна модель → запуск Sync → у спеку виводяться 2 і 3 графи для всіх КНС.
Мінімум 10 різних одиниць (лотки кількох типорозмірів, 90°/45° кути, кришки) — без ручного доповнення.
GE_Категорія коректно розбиває спеку на секції (поле приховане).
4) Backlog / nice-to-have
Автонумерація DKC_Позиция з урахуванням сортування в спеку.
Автоматична валідація моделей: відсутні сімейства/параметри → звіт.
Підтримка додаткових мовних шаблонів (укр/рос).
5) Шляхи / конфіг
CSV: Data/FamilyMap.csv (Copy Always).
INI: setup.ini (довжина лотка, дефолти).
Спека: GE_Специфікація кабеленесучих систем.
Параметри: GE_Категорія, GE_Найменування, GE_Артикул.
6) План відкату
Вимкнути запис у параметри (feature flag).
Повернутися до попередньої збірки (backup dll у релізній папці).
7) Відкриті питання
Точні правила кодування для всіх видів фітингів (TEE/RED/CROSS): погодити шаблони BaseArticle + розмірні сегменти.
Поведінка при відсутності ключа у FamilyMap: пропуск або маркування UNKNOWN_*.